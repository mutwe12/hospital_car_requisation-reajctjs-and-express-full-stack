<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Car Requisition Form</title>
<style>
    body { font-family: 'Times New Roman', Times, serif; background-color: #f5f5f5; padding: 20px; }
    .container { max-width: 850px; margin: 0 auto; background: #fff; padding: 40px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .form-group { display: flex; margin-bottom: 15px; align-items: center; }
    .form-group label { width: 250px; font-weight: bold; font-size: 14px; }
    .form-group input, .form-group select { flex: 1; border: none; border-bottom: 1px dotted #000; padding: 5px; font-size: 14px; background-color: transparent; outline: none; }
    .section-title { text-align: center; font-size: 16px; font-weight: bold; margin: 40px 0 20px 0; letter-spacing: 2px; color: #2c5f2d; border-top: 2px solid #ccc; padding-top: 15px; }
    .button-group { margin-top: 30px; text-align: center; }
    .btn { padding: 12px 30px; margin: 0 10px; font-size: 14px; border: none; cursor: pointer; border-radius: 4px; font-weight: bold; }
    .btn-primary { background-color: #2c5f2d; color: white; }
    .btn-primary:hover { background-color: #1e4620; }
    .btn-secondary { background-color: #6c757d; color: white; }
    .btn-secondary:hover { background-color: #545b62; }
</style>
</head>
<body>
<div class="container">
    <h2 style="text-align:center">CAR REQUISITION FORM</h2>
    <form id="carRequisitionForm">

        <!-- Request Section -->
        <div class="section-title">Request Details</div>
        <div class="form-group"><label>Date:</label><input type="date" id="date" required></div>
        <div class="form-group"><label>Department:</label><input type="text" id="department" required></div>
        <div class="form-group"><label>Requested by (Name & Title):</label><input type="text" id="requestedBy" required></div>
        <div class="form-group"><label>Purpose of Trip:</label><input type="text" id="purpose" required></div>
        <div class="form-group"><label>Destination:</label><input type="text" id="destination" required></div>
        <div class="form-group"><label>Departure (Date & Time):</label><input type="datetime-local" id="departure" required></div>
        <div class="form-group"><label>Return (Date & Time):</label><input type="datetime-local" id="return" required></div>
        <div class="form-group"><label>Passengers:</label><input type="text" id="passengers"></div>
        <div class="form-group"><label>Vehicle Type:</label>
            <select id="vehicleType">
                <option value="">Select Vehicle Type</option>
                <option value="sedan">Sedan</option>
                <option value="suv">SUV</option>
                <option value="van">Van</option>
                <option value="truck">Truck</option>
                <option value="ambulance">Ambulance</option>
            </select>
        </div>

        <!-- Logistics Section -->
        <div class="section-title">Logistics Section</div>
        <div class="form-group"><label>Department Responsible:</label><input type="text" id="deptResponsible" disabled></div>
        <div class="form-group"><label>Logistics Officer:</label><input type="text" id="logisticsOfficer" disabled></div>
        <div class="form-group"><label>Vehicle Plate:</label><input type="text" id="vehiclePlate" disabled></div>
        <div class="form-group"><label>Driver Name:</label><input type="text" id="driverName" disabled></div>
        <div class="form-group"><label>Actual Departure:</label><input type="datetime-local" id="actualDeparture" disabled></div>
        <div class="form-group"><label>Actual Return:</label><input type="datetime-local" id="actualReturn" disabled></div>

        <!-- DAF Approval Section -->
        <div class="section-title">DAF Approval Section</div>
        <div class="form-group"><label>DAF Approval:</label>
            <select id="dafApproved" disabled>
                <option value="">Select</option>
                <option value="approved">Approved</option>
                <option value="pending">Pending</option>
                <option value="rejected">Rejected</option>
            </select>
        </div>
        <div class="form-group"><label>Remarks:</label><input type="text" id="remarks" disabled></div>

        <!-- Buttons -->
        <div class="button-group">
            <button type="submit" class="btn btn-primary">Submit Form</button>
            <button type="button" class="btn btn-secondary" onclick="resetForm()">Clear Form</button>
        </div>
    </form>
</div>

<script>
const API_URL = "/api/requisition";

// Set today's date
document.getElementById('date').valueAsDate = new Date();

// Form submission handler
document.getElementById('carRequisitionForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    const formData = {
        date: document.getElementById('date').value,
        department: document.getElementById('department').value,
        requestedBy: document.getElementById('requestedBy').value,
        purpose: document.getElementById('purpose').value,
        destination: document.getElementById('destination').value,
        departure: document.getElementById('departure').value,
        return: document.getElementById('return').value,
        passengers: document.getElementById('passengers').value,
        vehicleType: document.getElementById('vehicleType').value,
        deptResponsible: document.getElementById('deptResponsible').value,
        logisticsOfficer: document.getElementById('logisticsOfficer').value,
        dafApproved: document.getElementById('dafApproved').value,
        vehiclePlate: document.getElementById('vehiclePlate').value,
        driverName: document.getElementById('driverName').value,
        actualDeparture: document.getElementById('actualDeparture').value,
        actualReturn: document.getElementById('actualReturn').value,
        remarks: document.getElementById('remarks').value
    };

    try {
        const res = await fetch(`${API_URL}/submit`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(formData)
        });

        const data = await res.json();
        alert(data.message);
        this.reset();
        document.getElementById('date').valueAsDate = new Date();
    } catch (err) {
        console.error("Error submitting form:", err);
        alert("Error submitting form. Check console.");
    }
});

// Reset function
function resetForm() {
    if (confirm('Are you sure you want to clear all form data?')) {
        document.getElementById('carRequisitionForm').reset();
        document.getElementById('date').valueAsDate = new Date();
    }
}
</script>
</body>
</html>
